class ByteArray{get endian(){return 0==this.$endian?"littleEndian":"bigEndian"}set endian(t){this.$endian="littleEndian"==t?0:1}get readAvailable(){return this.write_position-this._position}get buffer(){return this.data.buffer.slice(0,this.write_position)}set buffer(t){let e,i=t.byteLength,r=new Uint8Array(t),n=this.bufferExtSize;if(0==n)e=new Uint8Array(i);else{e=new Uint8Array((1+(i/n|0))*n)}e.set(r),this.write_position=i,this._bytes=e,this.data=new DataView(e.buffer)}get rawBuffer(){return this.data.buffer}get bytes(){return this._bytes}get dataView(){return this.data}set dataView(t){this.buffer=t.buffer}get bufferOffset(){return this.data.byteOffset}get position(){return this._position}set position(t){this._position=t,t>this.write_position&&(this.write_position=t)}get length(){return this.write_position}set length(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)}get bytesAvailable(){return this.data.byteLength-this._position}constructor(t,e){void 0===e&&(e=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,e<0&&(e=0),this.bufferExtSize=e;let i,r=0;if(t){let n=void 0;if(t instanceof Uint8Array?(n=t,r=t.length):(r=t.byteLength,n=new Uint8Array(t)),0==e)i=new Uint8Array(r);else{i=new Uint8Array((1+(r/e|0))*e)}i.set(n)}else i=new Uint8Array(e);this.write_position=r,this._position=0,this._bytes=i,this.data=new DataView(i.buffer),this.endian="bigEndian"}_validateBuffer(t){if(this.data.byteLength<t){let e=this.bufferExtSize,i=void 0;if(0==e)i=new Uint8Array(t);else{i=new Uint8Array((1+(t/e>>0))*e)}i.set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer)}}clear(){let t=new Uint8Array(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0}readInt(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}}readShort(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}}readByte(){if(this.validate(1))return this.data.getInt8(this.position++)}readBytes(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),t){var r=this._position,n=this.write_position-r;if(n<0)this.$error(1025);else{if(0==i)i=n;else if(i>n)return void this.$error(1025);t.validateBuffer(e+i),t._bytes.set(this._bytes.subarray(r,r+i),e),this.position+=i}}}readUTF(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""}readUTFBytes(t){if(this.validate(t)){var e=this.data,i=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(i)}}readUnsignedInt(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}}readUnsignedByte(){if(this.validate(1))return this._bytes[this.position++]}readUnsignedShort(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}}readBoolean(){if(this.validate(1))return!!this._bytes[this.position++]}readFloat(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}}readDouble(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}}writeUTF(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(2+i),this.data.setUint16(this._position,i,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)}writeUTFBytes(t){this._writeUint8Array(this.encodeUTF8(t))}writeInt(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4}writeShort(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2}writeByte(t){this.validateBuffer(1),this._bytes[this.position++]=255&t}writeBytes(t,e,i){var r;void 0===e&&(e=0),void 0===i&&(i=0),e<0||i<0||(r=0==i?t.length-e:Math.min(t.length-e,i))>0&&(this.validateBuffer(r),this._bytes.set(t._bytes.subarray(e,e+r),this._position),this.position=this._position+r)}writeBoolean(t){this.validateBuffer(1),this._bytes[this.position++]=+t}writeDouble(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8}writeFloat(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4}writeUnsignedInt(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4}writeUnsignedShort(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2}validate(t){let e=this._bytes.byteLength;return e>0&&this._position+t<=e||(this.$error(1025),!1)}validateBuffer(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)}encodeUTF8(t){for(var e=0,i=this.stringToCodePoints(t),r=[];i.length>e;){var n=i[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))r.push(n);else{var s=void 0,a=void 0;for(this.inRange(n,128,2047)?(s=1,a=192):this.inRange(n,2048,65535)?(s=2,a=224):this.inRange(n,65536,1114111)&&(s=3,a=240),r.push(this.div(n,Math.pow(64,s))+a);s>0;){var o=this.div(n,Math.pow(64,s-1));r.push(128+o%64),s-=1}}}return new Uint8Array(r)}decodeUTF8(t){for(var e,i=0,r="",n=0,s=0,a=0,o=0;t.length>i;){var l=t[i++];if(l==this.EOF_byte)e=0!=s?this.decoderError(!1):this.EOF_code_point;else if(0==s)this.inRange(l,0,127)?e=l:(this.inRange(l,194,223)?(s=1,o=128,n=l-192):this.inRange(l,224,239)?(s=2,o=2048,n=l-224):this.inRange(l,240,244)?(s=3,o=65536,n=l-240):this.decoderError(!1),n*=Math.pow(64,s),e=null);else if(this.inRange(l,128,191))if(a+=1,n+=(l-128)*Math.pow(64,s-a),a!==s)e=null;else{var h=n,u=o;n=0,s=0,a=0,o=0,e=this.inRange(h,u,1114111)&&!this.inRange(h,55296,57343)?h:this.decoderError(!1,l)}else n=0,s=0,a=0,o=0,i--,e=this.decoderError(!1,l);null!==e&&e!==this.EOF_code_point&&(e<=65535?e>0&&(r+=String.fromCharCode(e)):(e-=65536,r+=String.fromCharCode(55296+(e>>10&1023)),r+=String.fromCharCode(56320+(1023&e))))}return r}encoderError(t){this.$error(1026)}decoderError(t,e=0){return t&&this.$error(1027),e||65533}inRange(t,e,i){return e<=t&&t<=i}div(t,e){return Math.floor(t/e)}stringToCodePoints(t){for(var e=[],i=0,r=t.length;i<t.length;){var n=t.charCodeAt(i);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(i==r-1)e.push(65533);else{var s=t.charCodeAt(i+1);if(this.inRange(s,56320,57343)){var a=1023&n,o=1023&s;i+=1,e.push(65536+(a<<10)+o)}else e.push(65533)}else e.push(n);i+=1}return e}toString(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable}_writeUint8Array(t,e=!0){void 0===e&&(e=!0);var i=this._position,r=i+t.length;e&&this.validateBuffer(r),this.bytes.set(t,i),this.position=r}$error(t){throw new Error("错误号"+t+":")}}function GameCommonLibInit(){window.BitHelper=BitHelper,window.Gid=Gid,window.Mathf=Mathf,window.NumberTransfrom=NumberTransfrom,window.Pool=Pool,window.PoolObject=PoolObject,window.Random=Random,window.StringUtils=StringUtils,window.SyncHellper=SyncHellper,window.__NumberUnitText=__NumberUnitText,window.__NumberUnitValue=__NumberUnitValue,window.Dictionary=Dictionary,window.DoubleKeyList=DoubleKeyList,window.DoubleKeyMap=DoubleKeyMap,window.UnOrderMultiMap=UnOrderMultiMap,window.Bindable=Bindable,window.Emitter=Emitter,window.Observer=Observer,window.Signal=Signal,window.SignalHandler=SignalHandler,window.Typed2Signal=Typed2Signal,window.Typed2SignalHandler=Typed2SignalHandler,window.Typed3Signal=Typed3Signal,window.Typed3SignalHandler=Typed3SignalHandler,window.TypedSignal=TypedSignal,window.TypedSignalHandler=TypedSignalHandler,window.UnOrderMultiMap=UnOrderMultiMap,window.UnOrderMultiMap=UnOrderMultiMap,window.ByteArray=ByteArray}window.GameCommonLibInit=GameCommonLibInit;class BitHelper{static Contain(t,e){return 0!=(t&e)}static Add(t,e){return t|e}static BitUnset(t,e,i){return t&~((1<<e+1)-1<<i)}static BitSet(t,e,i,r){let n=(1<<e+1)-1;return t&~(n<<i)|(n&r)<<i}static BitGet(t,e,i){return t&(1<<e+1)-1<<i}static Bit2Str(t){let e=t/8/1024;if(e<1024)return StringUtils.FloatLength(e,100)+" KB";{let t=e/1024;return StringUtils.FloatLength(t,100)+" MB"}}static Byte2Str(t){let e=t/1024;if(e<1024)return StringUtils.FloatLength(e,100)+" KB";{let t=e/1024;return StringUtils.FloatLength(t,100)+" MB"}}}function isNumber(t){return"number"==typeof t}function isInt(t){var e;return null!=t&&(e=/\d*/i,t.match(e)==t)}function isString(t){return"string"==typeof t}function isNullOrEmpty(t){return t instanceof Array?null==t||null==t:null==t||null==t||""==t}function isNaNOrEmpty(t){return isNaN(t)||null==t}function getClassName(t){return t.constructor.name}function getFunctionName(t){return t.name||t.toString().match(/function\s*([^(]*)\(/)[1]}function getTime(){return(new Date).getTime()}function getTimeStamp(){return Math.floor(getTime()/1e3)}function bToStr(t){if(t<1024)return t+"B";return kbToStr(t/1024)}function kbToStr(t){if(t<1024)return Math.ceil(t)+"KB";let e=t/1024;if(e<1024)return Math.ceil(100*e)/100+"MB";let i=e/1024;return Math.ceil(100*i)/100+"GB"}function arrayRemoveItem(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)}function arrayCopyInt(t,e){t.length=0;for(let i=0,r=e.length;i<r;i++)t.push(e[i])}function objRestDefaultValue(t){for(let e in t){switch(typeof t[e]){case TypeName.mnumber:t[e]=0;break;case TypeName.mboolean:t[e]=!1;break;case TypeName.mstring:t[e]="";break;case TypeName.mobject:t[e]&&objRestDefaultValue(t[e])}}}function objCopyValue(t,e){for(let i in t){switch(typeof t[i]){case TypeName.mnumber:case TypeName.mstring:case TypeName.mboolean:e[i]=t[i];break;case TypeName.mobject:t[i]?(e[i]||(e[i]=new t[i].constructor),objCopyValue(t[i],e[i])):objRestDefaultValue(e[i])}}}function mapClear(t,e){e||t.forEach((t,e)=>{t.poolRecover&&t.poolRecover()}),t.clear()}function mapCopyValue(t,e,i){mapClear(e,i),t.forEach((t,i)=>{e.set(i,t)})}function mapClone(t,e,i,r){let n;return e?(mapClear(e),n=e):(n=Pool.createByClass(Map)).clear(),t.forEach((t,e)=>{n.set(e,t.clone())}),i&&(mapClear(t),Pool.recoverByClass(t)),n}function mapCloneBase(t,e){let i=Pool.createByClass(Map);return t.forEach((t,e)=>{i.set(e,t)}),e&&(mapClear(t,!0),Pool.recoverByClass(t)),i}function arrayClear(t,e){if(!e){let e;for(let i=0,r=t.length;i<r;i++)(e=t[i])&&e.poolRecover&&e.poolRecover()}t.length=0}function arrayCopyValue(t,e,i){arrayClear(e,i);for(let i=0,r=t.length;i<r;i++)e.push(t[i])}function arrayClone(t,e,i){let r;e?(arrayClear(e),r=e):(r=Pool.createByClass(Array)).length=0;for(let e=0,i=t.length;e<i;e++)r.push(t[e].clone());return i&&(arrayClear(t),Pool.recoverByClass(t)),r}function arrayCloneBase(t,e){let i=Pool.createByClass(Array);i.length=0;for(let e=0,r=t.length;e<r;e++)i.push(t[e]);return e&&(t.length=0,Pool.recoverByClass(t)),i}window.isNumber=isNumber,window.isInt=isInt,window.isString=isString,window.isNullOrEmpty=isNullOrEmpty,window.isNaNOrEmpty=isNaNOrEmpty,window.getClassName=getClassName,window.getFunctionName=getFunctionName,window.getTime=getTime,window.getTimeStamp=getTimeStamp,window.bToStr=bToStr,window.kbToStr=kbToStr,window.arrayRemoveItem=arrayRemoveItem,window.arrayCopyInt=arrayCopyInt,window.objRestDefaultValue=objRestDefaultValue,window.objCopyValue=objCopyValue,window.mapClear=mapClear,window.mapCopyValue=mapCopyValue,window.mapClone=mapClone,window.mapCloneBase=mapCloneBase,window.arrayClear=arrayClear,window.arrayCopyValue=arrayCopyValue,window.arrayClone=arrayClone,window.arrayCloneBase=arrayCloneBase;class Gid{static getGID(){return this._gid++}}Gid._gid=1;class Mathf{static FloatLength(t,e=100){return 0==e?Math.floor(t):Math.floor(t*e)/e}static clamp(t,e,i){return Math.max(Math.min(t,Math.max(e,i)),Math.min(e,i))}static Clamp01(t){return t<0?0:t>1?1:t}static Lerp(t,e,i){return t+(e-t)*Mathf.Clamp01(i)}static radian(t,e,i,r){let n=i-t,s=r-e;return Math.atan2(s,n)}static angle(t,e,i,r){return 180*this.radian(t,e,i,r)/Math.PI}static angleToRadian(t){return t*Math.PI/180}static radianToAngle(t){return 180*t/Math.PI}static distanceangle(t,e,i,r){let n=i-t,s=r-e;return Math.sqrt(n*n+s*s)}static directionPointX(t,e,i,r,n){return Math.cos(this.radian(t,e,i,r))*n+t}static directionPointY(t,e,i,r,n){return Math.sin(this.radian(t,e,i,r))*n+e}static radianPointX(t,e,i){return Math.cos(t)*e+i}static radianPointY(t,e,i){return Math.sin(t)*e+i}static anglePointX(t,e,i){return Math.cos(this.angleToRadian(t))*e+i}static anglePointY(t,e,i){return Math.sin(this.angleToRadian(t))*e+i}}class NumberTransfrom{constructor(){this.unms=["零","一","二","三","四","五","六","七","八","九"],this.digits=["","十","百","千"],this.units=["","万","亿","万亿","亿亿"]}checkIsNumbers(t){if(null==t)return!1;for(let e=0;e<t.length;e++){let i=parseInt(t[e]);if(isNaN(i))return!1}return!0}transfrom2(t){if(null==t)return"您输入的字符串地址为null！"}transfrom(t){if(null==t)return"您输入的字符串地址为null！";let e,i=t.toString();if(0==i.length)return"您输入的字符串长度为0，请输入要转换的数字！";if(i.length>16)return"您输入的字符串长度大于16，无法转换！";for(e=0;e<i.length&&"0"==i.charAt(e);e++);let r="",n=0,s=(i=i.substring(e)).length%4,a=s>0?Math.floor(i.length/4)+1:Math.floor(i.length/4);for(let t=a;t>0;t--){let e=4;t==a&&0!=s&&(e=s);let o=i.substring(n,n+e),l=o.length;for(let t=0;t<l;t++){let e=parseInt(o.substring(t,t+1));0==e?t<l-1&&parseInt(o.substring(t+1,t+2))>0&&!r.eEndsWith(this.unms[0])&&(r+=this.unms[0]):((1!=e||!r.eEndsWith(this.unms[0])&&0!=r.length||t!=l-2)&&(r+=this.unms[e]),r+=this.digits[l-t-1])}0!=parseInt(o)&&(r+=this.units[t-1]),n+=e}return r}}class Pool{static getPoolBySign(t){return Pool._poolDic[t]||(Pool._poolDic[t]=[])}static clearBySign(t){Pool._poolDic[t]&&(Pool._poolDic[t].length=0)}static recover(t,e){e.__InPool||(e.__InPool=!0,Pool.getPoolBySign(t).push(e))}static recoverByClass(t){if(t){var e=t.__className||t.constructor._$gid;e&&Pool.recover(e,t)}}static createByClass(t){return Pool.getItemByClass(Pool._getClassSign(t),t)}static _getClassSign(t){var e=t.__className||t._$gid;return e||(t._$gid=e=Gid.getGID()+""),e}static getItemByClass(t,e){if(!Pool._poolDic[t])return new e;var i=Pool.getPoolBySign(t);if(i.length){var r=i.pop();r.__InPool=!1}else r=new e;return r}static getItemByCreateFun(t,e,i){var r=Pool.getPoolBySign(t),n=r.length?r.pop():e.call(i);return n.__InPool=!1,n}static getItem(t){var e=Pool.getPoolBySign(t),i=e.length?e.pop():null;return i&&(i.__InPool=!1),i}}Pool._poolDic={};class PoolObject{clone(){return null}onPoolRecover(){}static PoolGet(){return Pool.createByClass(this)}poolRecover(){this.onPoolRecover(),Pool.recoverByClass(this)}}class Random{static range(t,e){let i=e-t,r=Math.random();return t+Math.floor(i*r)}static rangeBoth(t,e){let i=e-t,r=Math.random();return t+Math.round(i*r)}static rangeBetween(t,e){let i=e-t,r=Math.random();return 0==Math.round(r*i)?t+1:Math.round(r*e)==e?e-1:t+Math.round(r*i)-1}static GetDisorderList(t){let e=t.length,i=new Array,r=new Array;for(let r=0;r<e;r++)i.push(t[r]);for(;r.length<e;){let t=Random.range(0,i.length);-1===r.indexOf(i[t])&&(r.push(i[t]),i.splice(t,1))}return r}}function toStringArray(t,e=/[:,;&]/){return t.split(e)}function toIntArray(t,e=/[:,;&]/){let i=[],r=toStringArray(t,e);for(let t=0;t<r.length;t++)i.push(parseInt(r[t]));return i}function toFloatArray(t,e=/[:,;&]/){let i=[],r=toStringArray(t,e);for(let t=0;t<r.length;t++)i.push(parseFloat(r[t]));return i}function toInt(t){return parseInt(t)}function toFloat(t){return parseFloat(t)}function toBoolean(t){return!!t&&(isNumber(t)?0!=t:!isString(t)||("true"==t||0!=parseInt(t)))}function toBooleanArray(t,e=/[:,;&]/){let i=[],r=toStringArray(t,e);for(let t=0;t<r.length;t++)i.push(toBoolean(r[t]));return i}function configCellToArray(t,e=/[;]/){return toStringArray(t,e)}function csvGetInt(t,e){return parseInt(t[e])}function csvGetFloat(t,e){return parseFloat(t[e])}function csvGetBoolean(t,e){return toBoolean(t[e])}function csvGetString(t,e){return t[e]}function firstUpperCase(t){return t.replace(/\b(\w)(\w*)/g,function(t,e,i){return e.toUpperCase()+i.toLowerCase()})}function format(t,...e){try{return t.replace(/{(\d+(:.*)?)}/g,function(t,i){var r=t.split(":");r.length>1&&(i=i[0],t=r[1].replace("}",""));var n=formatPattern(t,e[i]);return void 0!==n&&null!=n?n:""})}catch(t){return""}}function formatPattern(t,e){switch(t){case"L":e=e.toLowerCase();break;case"U":e=e.toUpperCase()}return e}function isNullOrWhiteSpace(t){try{return null!=t&&"undefined"!=t&&t.replace(/\s/g,"").length<1}catch(t){return!1}}function isStartOrEndWithSpace(t){var e=t.indexOf(" "),i=t.lastIndexOf(" ");return 0==e||i==t.length-1}function isStartOrEndWithNumber(t){var e=t.charAt(0),i=t.charAt(t.length-1);return!(!isInt(e)&&!isInt(i))}function trim(t){return t.replace(/[\r\n]/g,"")}class __NumberUnitText{}__NumberUnitText.B="B",__NumberUnitText.M="M",__NumberUnitText.K="K";class __NumberUnitValue{}function formatNumberUnit(t,e=1){var i=(t>=10*__NumberUnitValue.B?(t/=__NumberUnitValue.B).toFixed(e+1).slice(0,-1)+__NumberUnitText.B:t>=10*__NumberUnitValue.M?(t/=__NumberUnitValue.M).toFixed(e+1).slice(0,-1)+__NumberUnitText.M:t>=10*__NumberUnitValue.K?(t/=__NumberUnitValue.K).toFixed(e+1).slice(0,-1)+__NumberUnitText.K:Math.floor(t)+"").split("."),r=parseInt(i[0]).toLocaleString("en-US");return i.length>=2&&(e>0?r=r+"."+i[1]:r+=i[1]),r}function formatArrayNumberUnit(t,...e){let i=[];for(var r=0;r<e.length;r++){var n=e[r];i.push(formatNumberUnit(n,n>1e3?1:0))}return t.format(...i)}function numberToLetter(t,e=!0){if(t<=0)return null;let i="";if(--t>26)return"";if(t<0)return"";let r=e?"A":"a";return i=String.fromCharCode(t+r.charCodeAt(0))}function getStringLength(t){for(var e=0,i=t.length,r=-1,n=0;n<i;n++)e+=(r=t.charCodeAt(n))>=0&&r<=128?1:2;return e}__NumberUnitValue.K=1e3,__NumberUnitValue.M=1e6,__NumberUnitValue.B=1e9,window.toStringArray=toStringArray,window.toIntArray=toIntArray,window.toFloatArray=toFloatArray,window.toInt=toInt,window.toFloat=toFloat,window.toBoolean=toBoolean,window.toBooleanArray=toBooleanArray,window.configCellToArray=configCellToArray,window.csvGetInt=csvGetInt,window.csvGetFloat=csvGetFloat,window.csvGetBoolean=csvGetBoolean,window.csvGetString=csvGetString,window.firstUpperCase=firstUpperCase,window.format=format,window.formatPattern=formatPattern,window.isNullOrWhiteSpace=isNullOrWhiteSpace,window.isStartOrEndWithSpace=isStartOrEndWithSpace,window.isStartOrEndWithNumber=isStartOrEndWithNumber,window.trim=trim,window.formatNumberUnit=formatNumberUnit,window.formatArrayNumberUnit=formatArrayNumberUnit,window.numberToLetter=numberToLetter;class StringUtils{static FloatLength(t,e=100){return Mathf.FloatLength(t,e).toString()}static FillLeft(t,e,i="0"){for(;t.length<e;)t=i+t;return t}static FillRight(t,e,i="0"){for(;t.length<e;)t+=i;return t}static get numberTransfrom(){return this._numberTransfrom||(this._numberTransfrom=new NumberTransfrom),this._numberTransfrom}static GetChineseNum(t){return this.numberTransfrom.transfrom(t)}}StringUtils.empty="";var TypeName,__awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function fulfilled(t){try{step(r.next(t))}catch(t){s(t)}}function rejected(t){try{step(r.throw(t))}catch(t){s(t)}}function step(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(fulfilled,rejected)}step((r=r.apply(t,e||[])).next())})};class SyncHellper{static waitTime(t){return __awaiter(this,void 0,void 0,function*(){return new Promise(e=>{setTimeout(()=>e(),t)})})}static waitFrame(t){return __awaiter(this,void 0,void 0,function*(){return new Promise(e=>{setTimeout(()=>e(),1e3/this.frameRate*t)})})}}SyncHellper.frameRate=60,function(t){t.mstring="string",t.mnumber="number",t.mboolean="boolean",t.mfunction="function",t.mobject="object"}(TypeName||(TypeName={}));class Dictionary{constructor(){this.dict={},this._count=0}get count(){return this._count}add(t,e){!1===this.hasKey(t)&&this._count++,this.dict[t]=e}set(t,e){!1===this.hasKey(t)&&this._count++,this.dict[t]=e}remove(t){this.hasKey(t)&&this._count--,delete this.dict[t]}hasKey(t){return null!=this.dict[t]}getValue(t){return this.dict[t]}getValueOrDefault(t,e){return this.hasKey(t)?this.getValue(t):e}__getDict(){return this.dict}getValues(){let t=[];for(var e in this.dict)t.push(this.dict[e]);return t}getKeys(){let t=[];for(var e in this.dict)t.push(e);return t}clear(){this.dict={},this._count=0}}class DoubleKeyList{constructor(){this.key1Dict=new Dictionary}getDict(t){return this.key1Dict.getValue(t)}getOrCreateDict(t){let e=this.key1Dict.getValue(t);return e||(e=new UnOrderMultiMap,this.key1Dict.add(t,e)),e}addItem(t,e,i){this.getOrCreateDict(t).addItem(e,i)}removeItem(t,e,i){let r=this.getDict(t);r&&r.removeItem(e,i)}getItemList(t,e){let i=this.getDict(t);return i?i.get(e):null}}class DoubleKeyMap{constructor(){this.key1Dict=new Map}getDict(t){return this.key1Dict.get(t)}getOrCreateDict(t){let e=this.key1Dict.get(t);return e||(e=new Map,this.key1Dict.set(t,e)),e}add(t,e,i){this.getOrCreateDict(t).set(e,i)}remove(t,e){let i=this.getDict(t);i&&i.delete(e)}removeValues(t){let e=this.getDict(t);if(e){let t=e.getKeys();for(let i of t)e.delete(i)}this.key1Dict.delete(t)}getValue(t,e){let i=this.getDict(t);return i?i.get(e):null}getValues(t){let e=this.getDict(t);return e?e.getValues():null}clear(){this.key1Dict.clear()}}class UnOrderMultiMap{constructor(){this.dictionary=new Map,this.queue=[]}FetchList(){if(this.queue.length>0){let t=this.queue.shift();return t.length=0,t}return[]}RecycleList(t){t.length=0,this.queue.length>100||this.queue.push(t)}sortItem(t,e){let i=this.dictionary.get(t);i&&(e?i.sort(e):i.sort())}addItem(t,e){let i=this.dictionary.get(t);i||(i=this.FetchList(),this.dictionary.set(t,i)),i.push(e)}removeItem(t,e){let i=this.dictionary.get(t);return!!i&&(!!arrayRemoveItem(i,e)&&(0==i.length&&(this.RecycleList(i),this.dictionary.delete(t)),!0))}removeList(t){let e=this.dictionary.get(t);return e&&this.RecycleList(e),this.dictionary.delete(t)}get count(){return this.dictionary.size}getAll(t){let e=this.dictionary.get(t);return e?e.slice(0):[]}get(t){return this.dictionary.get(t)}contains(t,e){let i=this.get(t);return!!i&&-1!=i.indexOf(e)}containsKey(t){return this.dictionary.has(t)}clear(){let t=this.dictionary.getValues();for(let e of t)this.RecycleList(e);this.dictionary.clear()}getKeys(){return this.dictionary.getKeys()}}class Bindable{constructor(t=null){this._changeWatcher=new TypedSignal,this._value=t}get value(){return this._value}set value(t){this.setValue(t)}add(t,e){this._changeWatcher.add(t,e)}remove(t,e){this._changeWatcher.remove(t,e)}removeAll(){this._changeWatcher.removeAll()}bindTo(t){this.value=t.value,t.add(t=>this.setValue(t),this)}unbind(t){t.remove(t=>this.setValue(t),this)}setValue(t){t!=this._value&&(this._value=t,this._changeWatcher.dispatch(t))}}class Emitter{constructor(t=!1){this.listeners={},this.isDispatchName=!1,this.isDispatchName=t}add(t,e,i){let r=!1,n=this.listeners[t];if(n){let t=n.length;for(let s=0;s<t;s++){n[s].comparAll(e,i)&&(r=!0)}}else this.listeners[t]=[];r||this.listeners[t].push(new Observer(e,i))}remove(t,e,i){let r=this.listeners[t];if(!r)return;let n=r.length;for(let t=0;t<n;t++){if(r[t].compar(i)){r.splice(t,1);break}}0==r.length&&delete this.listeners[t]}dispatch(t,...e){let i=this.listeners[t];if(i)for(let r=i.length-1;r>=0;r--){let n=i[r];this.isDispatchName?n.notify(t,...e):n.notify(...e)}}}class Observer{constructor(t,e){this.callback=null,this.context=null;this.callback=t,this.context=e}notify(...t){this.callback.call(this.context,...t)}compar(t){return t==this.context}comparAll(t,e){return t==this.callback&&e==this.context}}class Signal{constructor(){this._listeners=[]}add(t,e){this.hasListener(t,e)||this._listeners.push(new SignalHandler(t,e))}addOnce(t,e){this.hasListener(t,e)||this._listeners.push(new SignalHandler(t,e,!0))}hasListener(t,e){for(var i=0;i<this._listeners.length;i++)if(this._listeners[i].equals(t,e))return!0;return!1}remove(t,e){for(var i=0;i<this._listeners.length;i++)if(this._listeners[i].equals(t,e)){this._listeners.splice(i,1);break}}removeAll(){this._listeners.length=0}dispatch(){this._listeners.forEach(t=>t.apply()),this._listeners=this._listeners.filter((t,e,i)=>!t.once())}}class SignalHandler{constructor(t,e,i=!1){this._handler=t,this._self=e,this._once=i}apply(){this._handler.apply(this._self)}equals(t,e){return this._handler==t&&this._self==e}once(){return this._once}}class Typed2Signal{constructor(){this._listeners=[]}add(t,e){this.hasListener(t,e)||this._listeners.push(new Typed2SignalHandler(t,e))}addOnce(t,e){this.hasListener(t,e)||this._listeners.push(new Typed2SignalHandler(t,e,!0))}hasListener(t,e){for(var i=0;i<this._listeners.length;i++)if(this._listeners[i].equals(t,e))return!0;return!1}remove(t,e){for(var i=0;i<this._listeners.length;i++)if(this._listeners[i].equals(t,e)){this._listeners.splice(i,1);break}}removeAll(){this._listeners.length=0}dispatch(t,e){this._listeners.forEach(i=>i.apply(t,e)),this._listeners=this._listeners.filter((t,e,i)=>!t.once())}}class Typed2SignalHandler{constructor(t,e,i=!1){this._handler=t,this._self=e,this._once=i}apply(t,e){this._handler.apply(this._self,[t,e])}equals(t,e){return this._handler==t&&this._self==e}once(){return this._once}}class Typed3Signal{constructor(){this._listeners=[]}add(t,e){this.hasListener(t,e)||this._listeners.push(new Typed3SignalHandler(t,e))}addOnce(t,e){this.hasListener(t,e)||this._listeners.push(new Typed3SignalHandler(t,e,!0))}hasListener(t,e){for(var i=0;i<this._listeners.length;i++)if(this._listeners[i].equals(t,e))return!0;return!1}remove(t,e){for(var i=0;i<this._listeners.length;i++)if(this._listeners[i].equals(t,e)){this._listeners.splice(i,1);break}}removeAll(){this._listeners.length=0}dispatch(t,e,i){this._listeners.forEach(r=>r.apply(t,e,i)),this._listeners=this._listeners.filter((t,e,i)=>!t.once())}}class Typed3SignalHandler{constructor(t,e,i=!1){this._handler=t,this._self=e,this._once=i}apply(t,e,i){this._handler.apply(this._self,[t,e,i])}equals(t,e){return this._handler==t&&this._self==e}once(){return this._once}}class TypedSignal{constructor(){this._listeners=[]}add(t,e){this.hasListener(t,e)||this._listeners.push(new TypedSignalHandler(t,e))}addOnce(t,e){this.hasListener(t,e)||this._listeners.push(new TypedSignalHandler(t,e,!0))}hasListener(t,e){for(var i=0;i<this._listeners.length;i++)if(this._listeners[i].equals(t,e))return!0;return!1}remove(t,e){for(var i=0;i<this._listeners.length;i++)if(this._listeners[i].equals(t,e)){this._listeners.splice(i,1);break}}removeAll(){this._listeners.length=0}dispatch(t){this._listeners.forEach(e=>e.apply(t)),this._listeners=this._listeners.filter((t,e,i)=>!t.once())}}class TypedSignalHandler{constructor(t,e,i=!1){this._handler=t,this._self=e,this._once=i}apply(t){this._handler.apply(this._self,[t])}equals(t,e){return this._handler==t&&this._self==e}once(){return this._once}}GameCommonLibInit();